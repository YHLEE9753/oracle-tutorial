# 3.Oracle 유저 생성 및 Sample Data 주입

## User 생성 및 권한 부여
```
docker exec -it oracle sqlplus
user-name : system
password : 1234
```
oracle db 에 접속시 container database(CDB) 에 접속하게 된다
- 초기 이름은 ROOT 이다.
```oracle-sql
SQL> SHOW con_name;

CON_NAME
------------------------------
CDB$ROOT
```

pluggable database 로 switch 해야 한다. 우리는 docker 설정 시 ORACLE_PDB 로 YONGPDB 를 지정하였다.
```oracle-sql
SQL> ALTER SESSION SET CONTAINER = YONGPDB;

Session altered.
```
show 를 사용하면 현재 DB 는 CDB 내부에 우리가 설정한 PDB 인 YONGPDB 인 것을 확인할 수 있다.
```oracle-sql
SQL> SHOW con_name;

CON_NAME
------------------------------
YONGPDB
```
새로운 유저를 생성하기 전에 DB 를 open 해야 한다.
```oracle-sql
SQL> ALTER DATABASE OPEN;

Database altered.
```
pluggable DB 안에 새로운 유저를 만들자(id: yong, pw: 1234)
```oracle-sql
SQL> CREATE USER yong IDENTIFIED BY 1234;

User created.
```
유저에게 권한을 부여하자
```oracle-sql
SQL> GRANT CONNECT, RESOURCE, DBA TO yong;

Grant succeeded.
```
이제 user 라는 사용자를 통해 PDB 에 접속할 수 있따.
```oracle-sql
SQL> CONNECT yong@YONGPDB
Enter password:
Connected.
```

## Sample 데이터 생성 및 주입
[Download Oracle Sample Database](https://www.oracletutorial.com/wp-content/uploads/2019/01/oracle-sample-database.zip)

### Sample Data ERD
![img.png](../images/erd.png)

- `ot_create_user.sql` is for creating OT user and grant privileges
- `ot_schema.sql` is for creating database objects such as tables, constraints, etc.
- `ot_data.sql` is for loading data into the tables.
- `ot_drop.sql` is for removing all objects in the sample database.

### table 생성 및 데이터 주입
테이블을 만들기 위해 `ot_schema.sql` 를 실행해야한다<br>
SQL*plus 에서 파일에 있는 SQL statements 를 실행하기 위해 다음과 같은 형식으로 커맨드를 작성해햐 한다.
```oracle-sql
SQL>@path_to_sql_file
```

`ot_schema.sql` 가 있는 위치를 기반으로 sql 를 실행한다
```oracle-sql
SQL>@@(C:\Users\user\Desktop\oracle-sample-database\ot_schema.sql)
@@C:\Users\user\Desktop\oracle-sample-database\ot_schema.sql
```

> 만약 SP2-0310 에러가 발생한다면 
> 
docker exec -i oracle sqlplus yong/1234 <C:\Users\user\Desktop\oracle-sample-database\ot_schema.sql
성공적으로 실행되었는지 확인해 보자
```oracle-sql
SQL> SELECT table_name FROM user_tables ORDER BY table_name;

TABLE_NAME
--------------------------------------------------------------------------------
CONTACTS
COUNTRIES
CUSTOMERS
EMPLOYEES
INVENTORIES
LOCATIONS
ORDERS
ORDER_ITEMS
PRODUCTS
PRODUCT_CATEGORIES
REGIONS
WAREHOUSES

12 rows selected.
```