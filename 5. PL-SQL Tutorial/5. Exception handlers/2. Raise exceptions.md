# 2. Raise exceptions
- PL/SQL 를 사용하여 user-defined exception, internally defined exception 을 발생시키고 exception 을 다시 발생시키는 `RAISE` 문에 대해 알아보자
- 예외를 explicitly 명시적으로 발생시키기 위해 `RAISE` 문을 활용해야 한다.
  - Raise a user-defined exception.
  - Raise an internally defined exception.
  - Reraising the current exception.

## Raising a user-defined exception
### Declaring a user-defined exception
```oracle-sql
DECLARE
    exception_name EXCEPTION;
```
- 변수 선언과 마찬가지로 block 의 declare 부분에서 예외를 선언한다.
- 사용자 저의 예외에는  error_code 가 할당되어야 한다. 
- 이를 위해 EXCEPTION_INIT 과 PRAGMA 를 같이 사용한다.
```oracle-sql
PRAGMA EXCEPTION_INIT (exception_name, error_code)
```
- error_code 는 -20,999 ~ -20,000 사이의 integer 값이어야 한다.
- message 는 최대 2,048 bytes 의 길이를 가진 character string 이다.

```oracle-sql
DECLARE
    exception_name EXCEPTION;
    PRAGMA EXCEPTION_INIT (exception_name, error_number);
```
- 전체 syntax 는 다음과 같다.

### Raising a user-defined exception example
```oracle-sql
DECLARE
    e_credit_too_high EXCEPTION;
    PRAGMA exception_init( e_credit_too_high, -20001 );
    l_max_credit customers.credit_limit%TYPE;
    l_customer_id customers.customer_id%TYPE := &customer_id;
    l_credit customers.credit_limit%TYPE := &credit_limit;
BEGIN
    -- get the meax credit limit
    SELECT MAX(credit_limit) 
    INTO l_max_credit
    FROM customers;
    
    -- check if input credit is greater than the max credit
    IF l_credit > l_max_credit THEN 
        RAISE e_credit_too_high;
    END IF;
    
    -- if not, update credit limit
    UPDATE customers 
    SET credit_limit = l_credit
    WHERE customer_id = l_customer_id;
    
    COMMIT;
END;
/
```





